<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/main.css" />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.97em%22 font-size=%2280%22>ðŸ“Ÿ</text></svg>"
    />

    <script src="wasm_exec.js"></script>

    <script>
      async function createRunningEmulator() {
        removeFrame();
        emuFrame = createEmuFrame();
        const pgmName = document.querySelector("#program").value;
        emuFrame.setAttribute("data-pgm-name", "roms/" + pgmName);
        emuFrame.setAttribute("data-delay", 1);
        emuFrame.setAttribute("data-debug", document.querySelector("#debugCB").checked );
        document.body.appendChild(emuFrame);
      }

      async function createStoppedEmulator() {
        removeFrame();
        document.body.appendChild(createEmuFrame());
      }

      function removeFrame() {
        oldFrame = document.querySelector("#emulator");
        if (oldFrame) {
          document.body.removeChild(oldFrame);
        }
      }

      function createEmuFrame() {
        var emuFrame = document.createElement("iframe");
        emuFrame.src = "emulator.html";
        emuFrame.id = "emulator";
        emuFrame.width = 1000;
        emuFrame.height = 500;
        return emuFrame;
      }
    </script>
    <title>CHIP-8 ~ Go & WASM</title>
  </head>
  <body onload="createStoppedEmulator();">
    <select id="program">
      <option>BRIX</option>
      <option>INVADERS</option>
      <option>TANK</option>
      <option>TETRIS</option>
      <option>snake.ch8</option>
    </select>
    <button onclick="createRunningEmulator()">LOAD PROGRAM</button>
    <button onclick="createStoppedEmulator()">REBOOT SYSTEM</button>
    <input type="checkbox" id="debugCB"></input>
    <label style="word-wrap:break-word" for="debugCB">DEBUG</label>
    <footer>
      CHIP-8 Emulator in Go, Ben Coleman<br />
      <a href="https://github.com/benc-uk/chip8"> GitHub Project </a>
    </footer>
    <hr />
  </body>
</html>
